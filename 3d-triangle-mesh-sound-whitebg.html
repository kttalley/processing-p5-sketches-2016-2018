<html>
    <script src = "lib/p5.js"></script>
    <script>
        new p5 ();
        var mic;

let cols, rows;
let scl = 80;

function setup() {
    angleMode(DEGREES);
    mic = new p5.AudioIn();
    mic.start();
    rows = 700/scl;
    cols = 700/scl;
    createCanvas(700,700,WEBGL);
    strokeWeight(2);
    stroke(255);
    fill(0,200);
}

function draw() {
    micLevel = mic.getLevel();
    micMap = map(micLevel,0, 0.001, 1, 1000);
    // background(0);
    translate(-700/2,300);
    rotateX(90);
    for( let y = 0; y < rows; y++) {
                
        beginShape(TRIANGLE_STRIP);
        for(let x = 0; x < cols; x++) {
            vertex(x*scl, y*scl, random(micMap/900));
            vertex(x*scl, (y+1)*scl,random(micMap/900)+1);
        }
     endShape();
    }

        }
        
    </script>
</html>